---
layout: default
---

<div class="header-base header-small">
  <div class="central-holder">
    <div class="container central-container">
      <h1 class="ps-4 clip mask-farm animate__animated animate__backInRight">Place,
        Maps, and Code</h1>
      <p class="ps-4 mb-0 subtitle animate__animated animate__fadeInRight">
        Place, Maps, and Code is research and personal blog formed of my <b>thoughts</b>, <b>reflections</b>, and
        <b>tutorials</b> on all things related to <b>platial information</b>, <b>software development</b>, and
        <b>mapping technologies</b>.
      </p>
    </div>
  </div>
</div>

<div class="container my-4">
  <!-- Filters: search + tags -->
  {% assign all_tags = site.tags | sort %}
  {% assign tags_total = site.tags | size %}
  <div class="filters-bar mb-3">
    <div class="row g-2 align-items-center">
      <div class="col-12 col-md-6">
        <div class="input-group">
          <span class="input-group-text"><i class="bi bi-search"></i></span>
          <input id="post-search" type="search" class="form-control" placeholder="Search posts (title, subtitle, tags)" aria-label="Search posts" />
          <button id="clear-filters" class="btn btn-outline-secondary" type="button" aria-label="Clear filters">Clear</button>
        </div>
      </div>
      <div class="col-12 col-md-6">
        <div class="d-flex flex-wrap gap-1 justify-content-md-end chips-wrap">
          {% for tag in all_tags %}
            {% assign tag_name = tag[0] %}
            <button class="filter-chip" data-tag="{{ tag_name | escape }}" aria-pressed="false" {% if forloop.index > 10 %}data-more="true"{% endif %}>{{ tag_name }}</button>
          {% endfor %}
        </div>
      </div>
      {% if tags_total > 10 %}
      <div class="col-12 d-flex justify-content-end">
        <button class="filter-chip more-chip" data-more-toggle="true" aria-pressed="false" aria-expanded="false">More</button>
      </div>
      {% endif %}
    </div>
    <div class="row mt-2 selected-tags-row d-none">
      <div class="col-12 d-flex align-items-center gap-2 flex-wrap">
        <span class="text-muted small">Selected:</span>
        <div id="selected-tags" class="d-flex gap-1 flex-wrap"></div>
        <button id="reset-all" class="filter-chip reset-all" type="button"><i class="bi bi-x-circle me-1"></i>Reset all</button>
      </div>
    </div>
  </div>
  <div class="row g-4 posts-grid">
    {% for post in paginator.posts %}
  <div class="col-12 col-md-6">
  {% assign tags_str = post.tags | join: ' ' %}
  {% assign search_blob = post.title | append: ' ' | append: post.subtitle | append: ' ' | append: tags_str %}
  <a class="post-card d-block h-100 text-decoration-none" href="{{ site.baseurl }}{{ post.url }}" style="--accent: {{ post.displaytheme | default: '#2d3142' }};" data-tags="{{ tags_str | downcase }}" data-search="{{ search_blob | downcase }}">
        <div class="post-cover position-relative" role="img" aria-label="{{ post.title }}" {% if post.maskimage %}data-cover="{{ site.baseurl }}/images/titles/{{ post.maskimage }}"{% endif %}>
          {% assign days_since = 0 %}
          {% if post.date %}
            {% assign now_ts = "now" | date: "%s" %}
            {% assign post_ts = post.date | date: "%s" %}
            {% assign diff = now_ts | minus: post_ts %}
            {% assign days_since = diff | divided_by: 86400 %}
          {% endif %}
          {% if days_since <= 14 %}
            <span class="badge-new">New</span>
          {% endif %}
          {% if post.lastupdate %}
            <span class="badge-updated">Updated</span>
          {% endif %}
        </div>
        <div class="post-body p-3">
          <h3 class="post-title h5 mb-2"><i class="bi {{ post.icon }} me-1"></i> {{ post.title }}</h3>
          <p class="post-subtitle text-muted small mb-2">{{ post.subtitle }}</p>
          <div class="post-meta d-flex align-items-center gap-3 mb-2">
            <span class="date small"><i class="bi bi-clock me-1"></i>{{ post.date | date: "%b %e, %Y" }}</span>
            {% assign words = post.content | number_of_words %}
            {% assign mins = words | divided_by: 200 %}
            {% assign rem = words | modulo: 200 %}
            {% if rem > 0 %}{% assign mins = mins | plus: 1 %}{% endif %}
            <span class="time small"><i class="bi bi-journal-text me-1"></i>~{{ mins }} min</span>
            <span class="author small"><i class="bi bi-person me-1"></i>{{ post.author }}</span>
          </div>
          <div class="post-tags d-flex flex-wrap gap-1 mb-2">
            {% for t in post.tags limit:3 %}
              <span class="tag-chip">{{ t }}</span>
            {% endfor %}
          </div>
          <div class="post-cta text-end text-primary">
            <span class="fw-semibold">Read</span> <i class="bi bi-arrow-right"></i>
          </div>
        </div>
      </a>
    </div>
    {% endfor %}
  </div>
  <div id="no-results" class="no-results d-none text-center text-muted my-4">
    <i class="bi bi-info-circle me-1"></i>No posts match your filters.
  </div>
</div>

{% if paginator.total_pages > 1 %}
<div class="container">
  <nav class="pagination-modern mt-4 mb-5" aria-label="Pagination Navigation">
    <ul class="pagination justify-content-center flex-wrap gap-2">
      {% comment %} First & Prev {% endcomment %}
      <li class="page-item {% unless paginator.previous_page %}disabled{% endunless %}">
        <a class="page-link" href="{% if paginator.previous_page %}{{ site.baseurl }}/{% else %}#{% endif %}" aria-label="First">
          <i class="bi bi-chevron-double-left" aria-hidden="true"></i>
        </a>
      </li>
      <li class="page-item {% unless paginator.previous_page %}disabled{% endunless %}">
        <a class="page-link" href="{% if paginator.previous_page %}{{ site.baseurl }}{{ paginator.previous_page_path }}{% else %}#{% endif %}" aria-label="Previous">
          <i class="bi bi-chevron-left" aria-hidden="true"></i>
        </a>
      </li>

      {% comment %} Numbered pages with smart ellipses {% endcomment %}
      {% assign prev_shown = 0 %}
      {% for i in (1..paginator.total_pages) %}
        {% assign show = false %}
        {% if i == 1 or i == paginator.total_pages or i == paginator.page %}
          {% assign show = true %}
        {% endif %}
        {% assign prev_page = paginator.page | minus: 1 %}
        {% assign next_page = paginator.page | plus: 1 %}
        {% if i == prev_page or i == next_page %}
          {% assign show = true %}
        {% endif %}

        {% if show %}
          {% assign prev_shown_plus_1 = prev_shown | plus: 1 %}
          {% if prev_shown != 0 and i > prev_shown_plus_1 %}
            <li class="page-item disabled"><span class="page-link ellipsis" aria-hidden="true">&hellip;</span></li>
          {% endif %}
          <li class="page-item {% if i == paginator.page %}active{% endif %}" aria-current="{% if i == paginator.page %}page{% endif %}">
            <a class="page-link" href="{% if i == 1 %}{{ site.baseurl }}/{% else %}{{ site.baseurl }}/page{{ i }}/{% endif %}">{{ i }}</a>
          </li>
          {% assign prev_shown = i %}
        {% endif %}
      {% endfor %}

      {% comment %} Next & Last {% endcomment %}
      <li class="page-item {% unless paginator.next_page %}disabled{% endunless %}">
        <a class="page-link" href="{% if paginator.next_page %}{{ site.baseurl }}{{ paginator.next_page_path }}{% else %}#{% endif %}" aria-label="Next">
          <i class="bi bi-chevron-right" aria-hidden="true"></i>
        </a>
      </li>
      <li class="page-item {% unless paginator.next_page %}disabled{% endunless %}">
        <a class="page-link" href="{% if paginator.next_page %}{{ site.baseurl }}/page{{ paginator.total_pages }}/{% else %}#{% endif %}" aria-label="Last">
          <i class="bi bi-chevron-double-right" aria-hidden="true"></i>
        </a>
      </li>
    </ul>
    <div class="pagination-meta text-center mt-2">
      <small>Page {{ paginator.page }} of {{ paginator.total_pages }}</small>
    </div>
  </nav>
  
</div>
{% endif %}

<script>
(function(){
  const grid = document.querySelector('.posts-grid');
  if(!grid) return;
  // Apply cover images from data attribute
  grid.querySelectorAll('.post-cover[data-cover]')
      .forEach(el => { const url = el.getAttribute('data-cover'); if(url) el.style.backgroundImage = `url('${url}')`; });
  const cards = Array.from(grid.querySelectorAll('.post-card'));
  const searchInput = document.getElementById('post-search');
  const filtersBar = document.querySelector('.filters-bar');
  const chips = Array.from(document.querySelectorAll('.filter-chip[data-tag]'));
  const moreChip = document.querySelector('.filter-chip.more-chip');
  const clearBtn = document.getElementById('clear-filters');
  const noResults = document.getElementById('no-results');
  const selectedTagsWrap = document.getElementById('selected-tags');
  const selectedTagsRow = document.querySelector('.selected-tags-row');
  const resetAllBtn = document.getElementById('reset-all');
  let activeTags = new Set();

  function setShowAllTags(show){
    if(!filtersBar) return;
    if(show){ filtersBar.classList.add('show-all-tags'); moreChip?.setAttribute('aria-pressed','true'); moreChip?.setAttribute('aria-expanded','true'); moreChip && (moreChip.textContent = 'Less'); }
    else { filtersBar.classList.remove('show-all-tags'); moreChip?.setAttribute('aria-pressed','false'); moreChip?.setAttribute('aria-expanded','false'); moreChip && (moreChip.textContent = 'More'); }
  }

  function updateURL(){
    const params = new URLSearchParams(window.location.search);
    const q = (searchInput?.value || '').trim();
    if(q) params.set('q', q); else params.delete('q');
    if(activeTags.size){ params.set('tags', Array.from(activeTags).join(',')); } else { params.delete('tags'); }
    const newUrl = `${window.location.pathname}${params.toString() ? '?' + params.toString() : ''}${window.location.hash}`;
    history.replaceState(null, '', newUrl);
  }

  function applyFilters(){
    const q = (searchInput?.value || '').trim().toLowerCase();
    cards.forEach(card => {
      const text = card.getAttribute('data-search') || '';
      const tags = (card.getAttribute('data-tags') || '').split(/\s+/).filter(Boolean);
      const matchesText = !q || text.includes(q);
      const matchesTags = activeTags.size === 0 || Array.from(activeTags).every(t => tags.includes(t));
      card.closest('.col-12').style.display = (matchesText && matchesTags) ? '' : 'none';
    });
    const visible = grid.querySelectorAll('.col-12:not([style*="display: none"])').length;
    if(noResults){ noResults.classList.toggle('d-none', visible !== 0); }
    updateURL();
    renderSelectedTags();
  }

  chips.forEach(chip => {
    chip.addEventListener('click', () => {
      const t = chip.getAttribute('data-tag').toLowerCase();
      const pressed = chip.getAttribute('aria-pressed') === 'true';
      if(pressed){ activeTags.delete(t); chip.setAttribute('aria-pressed','false'); }
      else { activeTags.add(t); chip.setAttribute('aria-pressed','true'); }
      applyFilters();
    });
  });

  searchInput?.addEventListener('input', applyFilters);

  moreChip?.addEventListener('click', () => {
    const isExpanded = moreChip.getAttribute('aria-expanded') === 'true';
    setShowAllTags(!isExpanded);
  });

  clearBtn?.addEventListener('click', () => {
    searchInput && (searchInput.value = '');
    activeTags.clear();
    chips.forEach(c => c.setAttribute('aria-pressed','false'));
    applyFilters();
  });

  function renderSelectedTags(){
    if(!selectedTagsWrap || !selectedTagsRow) return;
    selectedTagsWrap.innerHTML = '';
    if(activeTags.size === 0){ selectedTagsRow.classList.add('d-none'); return; }
    selectedTagsRow.classList.remove('d-none');
    Array.from(activeTags).forEach(t => {
      const b = document.createElement('button');
      b.className = 'filter-chip selected-chip';
      b.type = 'button';
      b.setAttribute('data-tag', t);
      b.innerHTML = `<i class="bi bi-check2-circle me-1"></i>${t}`;
      b.addEventListener('click', () => {
        activeTags.delete(t);
        const chip = chips.find(c => c.getAttribute('data-tag').toLowerCase() === t);
        chip?.setAttribute('aria-pressed','false');
        applyFilters();
      });
      selectedTagsWrap.appendChild(b);
    });
  }

  resetAllBtn?.addEventListener('click', () => {
    searchInput && (searchInput.value = '');
    activeTags.clear();
    chips.forEach(c => c.setAttribute('aria-pressed','false'));
    applyFilters();
  });

  function parseInitialFilters(){
    const params = new URLSearchParams(window.location.search);
    let q = params.get('q') || '';
    let tagsParam = params.get('tags') || params.get('tag') || '';
    if(!tagsParam && window.location.hash){
      const hash = window.location.hash.replace(/^#/, '');
      const hashParams = new URLSearchParams(hash);
      tagsParam = hashParams.get('tags') || hashParams.get('tag') || '';
      q = q || hashParams.get('q') || '';
    }
    const initialTags = new Set(tagsParam.split(',').map(s => s.trim().toLowerCase()).filter(Boolean));
    if(searchInput) searchInput.value = q;
    if(initialTags.size){
      chips.forEach(chip => {
        const t = chip.getAttribute('data-tag').toLowerCase();
        if(initialTags.has(t)){
          chip.setAttribute('aria-pressed','true');
          activeTags.add(t);
        }
      });
      // If any selected tag is in the hidden set, expand the list
      const needsExpand = Array.from(initialTags).some(t => {
        const el = chips.find(c => c.getAttribute('data-tag').toLowerCase() === t);
        return el && el.hasAttribute('data-more');
      });
      if(needsExpand) setShowAllTags(true);
    }
    applyFilters();
  }

  // Initialize
  parseInitialFilters();
})();
</script>

<!-- from: https://jekyllrb.com/docs/pagination/ and https://getbootstrap.com/docs/5.3/components/pagination/-->