/* Enhanced Interactions Fixes - Ensure custom colors and background images work */

/* Fix for background images in clip text */
.header-base h1.clip {
    color: transparent !important;
    background-position: center center !important;
    background-attachment: fixed !important;
    background-size: cover !important;
    background-clip: text !important;
    -webkit-background-clip: text !important;
    -webkit-text-fill-color: transparent !important;
    background-repeat: no-repeat !important;
}

/* CRITICAL: Force custom displaytheme colors to work */
article[style*="background-color:"] {
    color: white !important;
}

/* Force all blog post sections to use their custom colors */
.posts article,
.post article {
    color: white !important;
}

/* Ensure text is white in colored sections */
.posts article h3,
.posts article h4,
.posts article h5,
.posts article p,
.posts article .lead,
.posts article a,
.post article h3,
.post article h4,
.post article h5,
.post article p,
.post article .lead,
.post article a {
    color: white !important;
    text-decoration: none !important;
}

/* Remove underlines from all links in colored sections */
.posts article a,
.post article a {
    text-decoration: none !important;
    border-bottom: none !important;
}

/* Fix for custom displaytheme colors - more specific */
[style*="background-color:"] {
    color: white !important;
}

[style*="background-color:"] h3,
[style*="background-color:"] h4,
[style*="background-color:"] h5,
[style*="background-color:"] p,
[style*="background-color:"] .lead,
[style*="background-color:"] a {
    color: white !important;
    text-decoration: none !important;
}

/* Ensure Bootstrap Icons are visible */
.bi {
    display: inline-block;
    font-family: "bootstrap-icons" !important;
    font-style: normal;
    font-weight: normal !important;
    font-variant: normal;
    text-transform: none;
    line-height: 1;
    vertical-align: middle;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

/* Read progress bar */
.read-progress { position: fixed; top: 0; left: 0; height: 3px; width: 100%; background: linear-gradient(90deg, #16a34a, #2563eb); transform-origin: 0 0; transform: scaleX(0); z-index: 2000; }

/* Post header meta chips */
.post-meta-chips { display: flex; gap: .5rem; flex-wrap: wrap; }
.post-meta-chips .meta-chip { display: inline-flex; align-items: center; gap: .25rem; padding: .25rem .5rem; border-radius: 999px; background: rgba(0,0,0,.06); color: #1f2937; font-size: .85rem; }
.post-meta-chips .meta-chip.updated { background: rgba(37, 99, 235, .12); color: #1e3a8a; }

/* ToC box */
.toc-box { width: 260px; background: #fff; border-radius: 12px; box-shadow: 0 6px 20px rgba(0,0,0,.08); padding: 1rem; position: sticky; top: 6rem; max-height: calc(100vh - 8rem); overflow: auto; }
.toc-box .toc-item { margin: .25rem 0; }
.toc-box .toc-h2 a { font-weight: 600; color: #2c3e50; }
.toc-box .toc-h3 a { padding-left: .5rem; color: #4b5563; font-size: .95rem; }
.toc-box a { text-decoration: none; }

/* Prevent overlap and improve spacing */
.entry { position: relative; }
.entry::after { content: ""; display: block; clear: both; }

/* Header text sizing */
.header-base h1 { font-size: clamp(1.75rem, 3.5vw, 3rem); }
.header-base .subtitle { font-size: clamp(1rem, 1.6vw, 1.25rem); }

/* Mobile TOC reveal */
@media (max-width: 991.98px) {
    .toc-box { position: relative; width: 100%; top: auto; max-height: none; margin-bottom: 1rem; float: none; }
}

/* Prevent enhanced-interactions from overriding important styles */
.geometric-bg {
    z-index: -1 !important;
    pointer-events: none !important;
}

.scroll-indicator {
    z-index: 9999 !important;
}

/* Ensure reveal animations don't break layout */
.reveal {
    opacity: 1 !important;
    transform: none !important;
}

.reveal.revealed {
    opacity: 1 !important;
    transform: none !important;
}

/* Fix for navbar shrink */
.navbar.scrolled {
    background-color: rgba(255, 255, 255, 0.95) !important;
    backdrop-filter: blur(10px) !important;
}

/* Ensure card enhancements don't break existing styles */
.card {
    transition: transform 0.3s ease, box-shadow 0.3s ease !important;
}

/* Fix for any transform conflicts */
.card:hover {
    transform: translateY(-4px) scale(1.01) !important;
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15) !important;
}

/* Fix for images in posts - contain them to 80% */
.entry img,
.post img,
article img {
    max-width: 80% !important;
    height: auto !important;
    display: block !important;
    margin: 1rem auto !important;
    border-radius: 8px !important;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1) !important;
}

/* Override any enhanced-interactions background interference */
.bg-green {
    background: linear-gradient(135deg, #4ac97f 0%, #5dd18f 50%, #70d99f 100%) !important;
    box-shadow: 0 4px 20px rgba(74, 201, 127, 0.3) !important;
    color: white !important;
}

/* CRITICAL: Preserve custom displaytheme colors and ensure they work */
div[style*="background-color:"] {
    color: white !important;
}

div[style*="background-color:"] h3,
div[style*="background-color:"] h4,
div[style*="background-color:"] h5,
div[style*="background-color:"] p,
div[style*="background-color:"] .lead,
div[style*="background-color:"] a {
    color: white !important;
    text-decoration: none !important;
}

/* If an element declares an inline background-color, disable theme gradients */
.bg-green[style*="background-color:"],
[style*="background-color:"] {
    background-image: none !important;
}

/* Accent helper for post header block */
.has-accent { background: var(--accent) !important; color: #fff !important; }
.has-accent h1, .has-accent h2, .has-accent h3, .has-accent h4, .has-accent h5, .has-accent h6,
.has-accent p, .has-accent li, .has-accent small, .has-accent span, .has-accent a, .has-accent strong, .has-accent em { color: #fff !important; }
.has-accent .tag-chip { background: rgba(255,255,255,.2) !important; color: #fff !important; border-color: rgba(255,255,255,.35) !important; }

/* Force all links to not be underlined */
a {
    text-decoration: none !important;
}

a:hover {
    text-decoration: none !important;
}

/* Home post cards grid */
.posts-grid { align-items: stretch; }
.post-card { border-radius: 14px; overflow: hidden; border: none; background: #fff; box-shadow: 0 6px 22px rgba(0,0,0,.06); transition: transform .12s ease, box-shadow .2s ease; display: flex; flex-direction: column; height: 100%; }
.post-card:hover { transform: translateY(-2px); box-shadow: 0 10px 28px rgba(0,0,0,.09); }
.post-cover { aspect-ratio: 16 / 9; background-size: cover; background-position: center; background-repeat: no-repeat; background-image: linear-gradient(135deg, var(--accent), #222); }
.post-body { display: flex; flex-direction: column; flex: 1; }
.post-title { color: #2c3e50; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; min-height: 2.6rem; line-clamp: 2; }
.post-subtitle { color: #6b7280; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; min-height: 2.8rem; line-clamp: 2; }
.post-meta { color: #6b7280; min-height: 1rem; }
.tag-chip { display: inline-block; padding: .15rem .5rem; border-radius: 999px; font-size: .75rem; background: rgba(45,49,66,.08); color: #2d3142; }
.post-tags { height: 1.6rem; overflow: hidden; white-space: nowrap; }
.post-cta { margin-top: auto; }

/* Filter bar */
.filters-bar .chips-wrap { max-height: 80px; overflow: hidden; }
.filters-bar.show-all-tags .chips-wrap { max-height: none; overflow: visible; }
.filters-bar .filter-chip { border: 1px solid rgba(0,0,0,.1); background: #fff; color: #2c3e50; border-radius: 999px; padding: .35rem .7rem; font-size: .85rem; cursor: pointer; transition: background .2s ease, color .2s ease, box-shadow .2s ease; }
.filters-bar .filter-chip:hover { background: #f3f4f6; }
.filters-bar .filter-chip[aria-pressed="true"] { background: #2d3142; color: #fff; box-shadow: 0 2px 8px rgba(45,49,66,.25); border-color: transparent; }
.filters-bar .filter-chip.more-chip { border-style: dashed; }
.filters-bar .reset-all { background: #fef2f2; color: #b91c1c; border-color: rgba(185,28,28,.3); }
.filters-bar .reset-all:hover { background: #fee2e2; }
.selected-tags-row .selected-chip { background: #e0f2fe; color: #075985; border-color: rgba(7,89,133,.25); }
.selected-tags-row .selected-chip:hover { background: #bae6fd; }
.no-results { font-size: .95rem; }

@media (max-width: 576px) {
    /* aspect-ratio maintains height automatically */
}

    /* Badges */
    .badge-new, .badge-updated { position: absolute; top: .5rem; padding: .25rem .5rem; border-radius: .5rem; font-size: .75rem; color: #fff; box-shadow: 0 2px 8px rgba(0,0,0,.15); }
    .badge-new { left: .5rem; background: #16a34a; }
    .badge-updated { right: .5rem; background: #2563eb; }

    /* Lazy load is handled in markup or JS */
/* Modern pagination styles */
.pagination-modern .pagination {
    gap: .25rem;
}

.pagination-modern .page-item .page-link {
    border: none !important;
    border-radius: 999px !important;
    padding: .5rem .8rem !important;
    min-width: 2.25rem;
    text-align: center;
    background: #f2f3f5;
    color: #2c3e50;
    box-shadow: inset 0 0 0 1px rgba(0,0,0,0.06);
    transition: background .2s ease, color .2s ease, box-shadow .2s ease, transform .1s ease;
}

.pagination-modern .page-item .page-link:hover {
    background: #e9ecef;
}

.pagination-modern .page-item.active .page-link,
.pagination-modern .page-item .page-link[aria-current="page"] {
    background: #2d3142;
    color: #fff;
    box-shadow: 0 2px 8px rgba(45,49,66,.25);
}

.pagination-modern .page-item.disabled .page-link {
    background: #f7f7f9;
    color: #a0a6b0;
    box-shadow: inset 0 0 0 1px rgba(0,0,0,0.04);
    pointer-events: none;
}

.pagination-modern .page-link.ellipsis {
    background: transparent;
    box-shadow: none;
}

@media (max-width: 576px) {
  .pagination-modern .pagination { gap: .2rem; }
  .pagination-modern .page-item .page-link { padding: .45rem .7rem; min-width: 2rem; }
}

/* Post pager styles */
.post-pager .pager-card {
    flex: 1 1 0;
    min-height: 84px;
    padding: 1rem 1.25rem;
    border-radius: 12px;
    background: #f8f9fb;
    box-shadow: inset 0 0 0 1px rgba(0,0,0,0.06);
    color: #2c3e50;
    transition: background .2s ease, transform .1s ease, box-shadow .2s ease;
}
.post-pager .pager-card:hover { background: #eef1f5; transform: translateY(-1px); box-shadow: 0 2px 10px rgba(0,0,0,.06); }
.post-pager .pager-card.disabled { visibility: hidden; }

/* Recommendation cards */
.post-recommendations .card { border: none; border-radius: 12px; box-shadow: 0 4px 18px rgba(0,0,0,.06); overflow: hidden; }
.post-recommendations .card-img-top.placeholder { height: 140px; }
.post-recommendations img.card-img-top { height: 140px; object-fit: cover; }
.post-recommendations .card-cover { aspect-ratio: 16 / 9; background-size: cover; background-position: center; background-repeat: no-repeat; }
.post-recommendations .card-title { color: #2c3e50; }
.post-recommendations .card-text { color: #4a5568; }
